import{d as m,n as c,l as b,q as k,o as f,f as v,a as p,e as y}from"./index-DblQHoIm.js";import{_}from"./plugin-vueexport-helper-DlAUqK2U.js";const B={class:"input-tag"},N=m({__name:"InputTag",setup(R){const o=c(),r=()=>{const t=window.getSelection&&window.getSelection();t&&t.rangeCount&&(o.value=t.getRangeAt(0))};b(()=>{document.addEventListener("selectionchange",r,!1),a.value.addEventListener("keydown",t=>{t.key==="Enter"&&(console.log("enter"),t.preventDefault())})}),k(()=>{document.removeEventListener("selectionchange",r,!1)});const a=c(),w=t=>{const e=`<input type="button" value='${t}' />`;h(e);const n=a.value.innerHTML;l.value=n},l=c(),T=t=>{console.log("input",t);const e=t.target.innerHTML.toString().replace(/(\r\n)|(\n)|(<br>)/g,"");l.value=e},C=()=>{a.value.focus()},s=c(),x=()=>{console.log("Blur")},A=()=>{if(console.log("Focus"),s.value&&s.value.rangeCount>0&&document.createRange){const t=document.createRange();t.setStart(s.value.getRangeAt(0).startContainer,s.value.getRangeAt(0).startOffset),t.collapse(!0);const e=window.getSelection();e.removeAllRanges(),e.addRange(t)}},S=t=>{t.stopPropagation(),t.preventDefault();let e="";const n=t.originalEvent||t;n.clipboardData&&n.clipboardData.getData?e=n.clipboardData.getData("text/plain"):window.clipboardData&&window.clipboardData.getData&&(e=window.clipboardData.getData("Text")),document.queryCommandSupported("insertText")?document.execCommand("insertText",!1,e):document.execCommand("paste",!1,e)},h=t=>{let e,n;if(window.getSelection){if(e=window.getSelection(),e&&e.rangeCount===0&&o.value!==null&&e.addRange(o.value),e&&e.rangeCount&&(n=e.getRangeAt(0)),["",null,void 0].includes(n))n=d().getRangeAt(0);else{const i=document.createRange();i.selectNode(a.value);const D=n.compareBoundaryPoints(Range.START_TO_START,i),E=n.compareBoundaryPoints(Range.END_TO_END,i);D!==-1&&E!==1||(n=d().getRangeAt(0))}const u=n.createContextualFragment(t),g=u.lastChild;n.insertNode(u),g&&(n=n.cloneRange(),n.setStartAfter(g),n.collapse(!0),e.removeAllRanges(),e.addRange(n))}else document.selection&&document.selection.type!=="Control"&&document.selection.createRange().pasteHTML(t)},d=t=>{if(window.getSelection){a.value.focus();const e=window.getSelection();return e.selectAllChildren(l.value),e.collapseToEnd(),e}else if(document.selection){const e=document.selection.createRange();return e.moveToElementText(l.value),e.collapse(!1),e.select(),e}};return(t,e)=>(f(),v("div",B,[p("button",{class:"btn",onClick:e[0]||(e[0]=n=>w("TAG"))},"添加标签"),p("div",{ref_key:"inputRef",ref:a,class:"myTextArea",contenteditable:"true",placeholder:"请输入",onClick:C,onInput:T,onBlur:x,onFocus:A,onPaste:S},null,544)]))}}),H=_(N,[["__scopeId","data-v-a92c9277"]]),I={class:"input-tag-container"},L=m({__name:"index",setup(R){return(o,r)=>(f(),v("div",I,[y(H)]))}}),$=_(L,[["__scopeId","data-v-061346c1"]]);export{$ as default};
