import{d as C,c as b,o as S,a as x,H as X,I as z,J as O,_ as B,i as E,w as H,k as j,j as F,b as o,z as p,A as _,e as m,t as w,p as J,l as U}from"./index-D3_7qBq7.js";const q=C({__name:"Tag",props:{type:{},light:{type:Boolean},ghost:{type:Boolean},allowClear:{type:Boolean}},setup(c){const a=c,h=b(()=>{let s=`custom-tag custom-tag-${a.type}`;return a.light&&(s+=" custom-tag-light"),a.ghost&&(s+=" custom-tag-ghost"),{class:s}});return(s,i)=>(S(),x("div",z(O(h.value)),[X(s.$slots,"default",{},void 0,!0)],16))}}),v=B(q,[["__scopeId","data-v-8761e710"]]),A=c=>(J("data-v-ea18ec5c"),c=c(),U(),c),G={class:"input-tag-wrapper"},K={class:"box-item"},Q=A(()=>o("div",{class:"title"},"标签",-1)),W={class:"content"},Y={class:"box-item"},Z=A(()=>o("div",{class:"title"},"输入框",-1)),ee={class:"content"},te={class:"rule-input"},ne={class:"box-item"},oe=A(()=>o("div",{class:"title"},"预览",-1)),se={class:"content"},ae={class:"rule-preview"},f={INDEX:"索引",TIME:"日期"},le=C({__name:"InputTag",props:{rule:{default:""}},setup(c){const a=c,h=b(()=>P(s.value,1)),s=E(a.rule);H(()=>a.rule,()=>{s.value=a.rule});const i=E();H(i,()=>{i.value&&(i.value.innerHTML=a.rule)});const D=E(),N=()=>{const n=window.getSelection&&window.getSelection();n&&n.rangeCount&&(D.value=n.getRangeAt(0))};j(()=>{document.addEventListener("selectionchange",N,!1)}),F(()=>{document.removeEventListener("selectionchange",N,!1)});const V=n=>{const e=n.target.innerHTML;s.value=e},L=()=>{},I=n=>{const e=`${n}`;k(e);const t=i.value.innerHTML;s.value=t},$=n=>{const e=`<input type="button" value='${f[n]}' />`;k(e);const t=i.value.innerHTML;s.value=t},P=(n,e,t)=>{let l=n||"";const R=/<input[^>]+>/g,r=l.match(R);if(!r)return l;for(let d=0;d<r.length;d++){const T=/value="([^"]*)"/,u=r[d].match(T);if(u){let g="";const y=u[1];y==f.INDEX?g=e+"":y==f.TIME&&(g=new Date().toLocaleString()),l=l.replace(r[d],g)}}return console.log(l),l},k=n=>{var r,d;const e=window.getSelection();if(!e)return;let t;if(e&&e.rangeCount&&(t=e.getRangeAt(0)),["",null,void 0].includes(t))t=(r=M())==null?void 0:r.getRangeAt(0);else{const T=document.getElementById("edit"),u=document.createRange();u.selectNode(T);const g=t.compareBoundaryPoints(Range.START_TO_START,u),y=t.compareBoundaryPoints(Range.END_TO_END,u);g!==-1&&y!==1||(t=(d=M())==null?void 0:d.getRangeAt(0))}console.log(t);const l=t.createContextualFragment(n),R=l.lastChild;t.insertNode(l),R&&(t=t.cloneRange(),t.setStartAfter(R),t.collapse(!0),e.removeAllRanges(),e.addRange(t))},M=n=>{const e=document.getElementById("edit");e==null||e.focus();const t=window.getSelection();return t.selectAllChildren(e),t.collapseToEnd(),t};return(n,e)=>(S(),x("div",G,[o("div",K,[Q,o("div",W,[p(v,{ghost:"",type:"primary",onClick:e[0]||(e[0]=t=>I("常量名称1"))},{default:_(()=>[m(" 常量 - 名称1 ")]),_:1}),p(v,{ghost:"",type:"primary",onClick:e[1]||(e[1]=t=>I("常量名称2"))},{default:_(()=>[m(" 常量 - 名称2 ")]),_:1}),p(v,{ghost:"",type:"primary",onClick:e[2]||(e[2]=t=>I("常量名称3"))},{default:_(()=>[m(" 常量 - 名称3 ")]),_:1}),p(v,{type:"primary",onClick:e[3]||(e[3]=t=>$("INDEX"))},{default:_(()=>[m(" 变量 - "+w(f.INDEX),1)]),_:1}),p(v,{type:"primary",onClick:e[4]||(e[4]=t=>$("TIME"))},{default:_(()=>[m(" 变量 - "+w(f.TIME),1)]),_:1})])]),o("div",Y,[Z,o("div",ee,[o("div",te,[o("div",{id:"edit",ref_key:"innerRuleRef",ref:i,class:"common-name-rule-input",contenteditable:"true",placeholder:"请输入",onInput:V,onBlur:L},null,544)])])]),o("div",ne,[oe,o("div",se,[o("div",ae,w(h.value),1)])])]))}}),ce=B(le,[["__scopeId","data-v-ea18ec5c"]]),ie={class:"input-tag-container"},re=C({__name:"index",setup(c){return(a,h)=>(S(),x("div",ie,[p(ce)]))}}),pe=B(re,[["__scopeId","data-v-c85c907e"]]);export{pe as default};
