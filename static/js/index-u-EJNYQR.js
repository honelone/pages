import{d as M,c as s,w as T,h as p,a as x,b as m,F as A,r as D,q as k,o as L,G as R,j as V,A as $,C as j,D as z,J as q,p as F,k as G,t as J,_ as P}from"./index-DwJGF_ix.js";const U=M({__name:"VirtualScroller",props:{list:{default:()=>[]},height:{default:300},itemHeight:{default:32},preloadNum:{default:5}},emits:["arriveBottom"],setup(a,{emit:g}){const t=a,d=g,h=s(()=>t.list.length*t.itemHeight),v=s(()=>!h.value||!t.height||!f.value?!1:f.value+t.height>=h.value);T(v,()=>{v.value&&d("arriveBottom")});const e=s(()=>({width:"100%",height:`${t.height}px`,"overflow-y":"auto"})),N=s(()=>{let n=l.value*t.itemHeight,u=h.value-n;return u<0&&(u=h.value,n=0),{width:"100%",height:`${u}px`,marginTop:`${n}px`}}),f=p(0),b=n=>{f.value=n.target.scrollTop},y=s(()=>t.preloadNum&&!isNaN(t.preloadNum)&&t.preloadNum>0?t.preloadNum:5),H=s(()=>t.height?Math.ceil(t.height/t.itemHeight):0),o=s(()=>Math.floor(f.value/t.itemHeight)),l=s(()=>{const n=o.value-y.value;return n<0?0:n}),i=s(()=>{const n=o.value+H.value+y.value;return n>t.list.length?t.list.length:n}),r=s(()=>t.list.slice(l.value,i.value));return(n,u)=>(L(),x("div",{ref:"outerScrollerRef",style:k(e.value),onScroll:b},[m("div",{ref:"innerScrollerRef",style:k(N.value)},[(L(!0),x(A,null,D(r.value,(_,c)=>(L(),x("div",{key:_.name,style:k({height:`${t.itemHeight}px`})},[R(n.$slots,"default",{index:c+l.value,item:_})],4))),128))],4)],36))}});function E(a){const t=p((()=>{const e=document.createElement("div");return e.style.position="absolute",e.style.top="0",e.style.left="0",e.style.width="100%",e.style.height="100%",e.style.display="flex",e.style.alignItems="center",e.style.justifyContent="center",e.style.zIndex="9999",e.style.backgroundColor="rgba(0, 0, 0, 0.5)",e.innerHTML="Loading...",e.style.visibility="hidden",e})());T(a,()=>{if(a){const e=a.value;e==null||e.appendChild(t.value)}else{const e=document.body;e==null||e.appendChild(t.value)}});const d=p(!1);return{loading:d,startLoading:()=>{t.value.style.visibility="visible",d.value=!0},endLoading:()=>{t.value.style.visibility="hidden",d.value=!1}}}const K=a=>(F("data-v-a864fd5d"),a=a(),G(),a),O={class:"virtual-list-container"},Q={class:"content-header"},W=K(()=>m("div",{class:"title"},"虚拟列表",-1)),X=M({__name:"index",setup(a){const g=p(),t=s(()=>{var o;return((o=g.value)==null?void 0:o.clientHeight)-96}),{startLoading:d,endLoading:h}=E(g),v=p(""),e=p([]),N=s(()=>e.value.filter(o=>o.name.includes(v.value)));V(()=>{e.value=y()});const f=()=>{e.value=[...e.value,...y(50)]},b=()=>{d(),setTimeout(()=>{f(),h()},1e3*2)},y=(o=200)=>{const l=[],i=o;for(let r=0;r<i;r++)l.push({name:H(10)});return l};function H(o){const l="abacdefghjklmnopqrstuvwxyzABCDEFGHJKLMNOPQRSTUVWXYZ0123456789",r=l.length-1;let n="";o=o||15;for(let u=0,_;u<o;u++)_=function(c,S){return c(0,r,S,c)}(function(c,S,B,C){let w=Math.floor(Math.random()*(S-c+1)+c);const I=l.length-10;return B==0&&w>=I&&(w=C(c,S,B,C)),w},u),n+=l[_];return n}return(o,l)=>(L(),x("div",O,[m("div",{ref_key:"contentRef",ref:g,class:"content"},[m("div",Q,[W,$(m("input",{"onUpdate:modelValue":l[0]||(l[0]=i=>v.value=i)},null,512),[[j,v.value]]),m("button",{onClick:f},"手动添加数据")]),z(U,{list:N.value,itemHeight:28,height:t.value,onArriveBottom:b},{default:q(({item:i,index:r})=>[m("div",null,J(r+"-"+i.name),1)]),_:1},8,["list","height"])],512)]))}}),Z=P(X,[["__scopeId","data-v-a864fd5d"]]);export{Z as default};
