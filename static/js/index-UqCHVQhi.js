import{_ as L,o as M,a as R,b as s,d as ae,c as se,h as G,j as ce,t as ee,z as E,v as le,p as re,k as ie,l as ue}from"./index-lBn8_SII.js";function de(){let d={screenSize:[13,20],intervals:1e3},p,T,_=0;const S=new Map;let m=!0,j=null,O=null,x="",A="",y=[0,0],h=new Set;const r="bg";let H=0,o=()=>{};const Z=["I","L","J","Z","S","T","O"],X={I:[[1,1,1,1]],L:[[1,1,1],[1,0,0]],J:[[1,1,1],[0,0,1]],Z:[[1,1,0],[0,1,1]],S:[[0,1,1],[1,1,0]],T:[[1,1,1],[0,1,0]],O:[[1,1],[1,1]]},$=function(e={}){K(e)};$.create=(e={})=>new $(e),$.prototype={get map(){return[...S.values()]},get status(){return _},get isPause(){return m},get score(){return H},get nextShap(){return{type:A,shapData:O}}},$.prototype.ready=function(){console.log("ready: "),_===0&&(Y(),U(),_=1)},$.prototype.play=function(){_===1&&(_=2),m&&(m=!1,W())},$.prototype.pause=function(){m=!0},$.prototype.over=function(){_=3},$.prototype.again=function(e={}){K(e),this.ready()},$.prototype.update=function(e){o=e},$.prototype.action=function(e){const[t,n]=y;_!==2||m||(e==="left"?N([t-1,n]):e==="right"?N([t+1,n]):e==="lower"?N([t,n+1],!0):e==="change"&&q())};const K=(e={})=>{d={...d,...e},p=d.screenSize,T=d.intervals,y=[0,0],h=new Set,_=0,H=0,m=!0;const{datas:t,index:n}=Q();O=t,A=n},Y=()=>{const[e,t]=p;for(let n=0;n<t;n++)for(let a=0;a<e;a++){const c=[a,n];S.set(B(c),{type:r,vector:c})}},U=()=>{const[e]=p;j=O,x=A,y=[Math.floor(e/2)-(!(e&1)&&x==="I"?2:1),0];const t=w(y);l(t,x,!1);const{datas:n,index:a}=Q();O=n,A=a,k(t)&&(_=3),o()},W=()=>{if(!(m||_===3)){if(_===2){const[e,t]=y;N([e,t+1],!0)}setTimeout(()=>{W()},T)}},Q=()=>{const e=Math.random()*Z.length<<0,t=Z[e];return{index:t,datas:X[t]}},N=([e,t],n=!1)=>{const a=w([e,t]);if(n===!0&&D([e,t])){P(),U();return}F(a)||g(a)||I([e,t])},I=e=>{let t=w(y);l(t,r),t=w(e),l(t,x),y=e,o()},l=(e,t,n=!0)=>{e.forEach(a=>{const c=B(a);!n&&S.get(c).type!==r||S.set(c,{type:t,vector:a})})},P=()=>{const e=V();J(e)},V=()=>{const[e,t]=p,n=[];for(let a=t-1;a>=0;a--){let c=!0;for(let i=0;i<e;i++)if(S.get(B([i,a])).type===r){c=!1;break}c&&n.push(a)}return H+=n.length,n},w=([e,t],n=j)=>{const a=n.length,c=n[0].length,i=[];for(let f=0;f<a;f++)for(let u=0;u<c;u++)if(n[f][u]===1){let C=[u+e,f+t];x==="I"&&a>=4?C=[u+e+1,f+t-1]:x==="O"&&(C[0]+=1),i.push(C)}return i},J=e=>{const[t]=p;z([...e]).forEach(a=>{for(let c=a;c>=0;c--)for(let i=0;i<t;i++){if(c===a){const te=B([i,c]);S.set(te,{type:r,vector:[i,c]}),h.delete(te);continue}const f=B([i,c]),u=B([i,c+1]),C=S.get(f),oe=S.get(u);C.type!==r&&oe.type===r&&(S.set(f,{type:r,vector:[i,c]}),S.set(u,{type:C.type,vector:[i,c+1]}),h.delete(f),h.add(u))}})},q=()=>{const e=ne(j),t=w(y,e);F(t)||g(t)||(l(w(y),r),l(t,x),j=e,o())},D=e=>{const t=w(e);if(F(t)||g(t)){const n=w(y).map(a=>B(a));return h=new Set([...h,...n]),!0}return!1},F=e=>{const[t,n]=p;return e.some(([a,c])=>a<0||a>=t||c>=n)},g=e=>e.some(t=>h.has(B(t))),k=e=>{const[,t]=y;return!!(t<=0&&g(e))},z=(e,t=[])=>{if(e.length<=0)return t;const n=Math.min(...e),a=e.indexOf(n);return t.push(e.splice(a,1)[0]),z(e,t)},ne=(e,t=!0)=>{const n=e[0].length,a=e.length,c=n-1,i=a-1,f=[];for(let u=0;u<n;u++){f[u]=[];for(let C=0;C<a;C++){if(t){f[u].push(e[i-C][u]);continue}f[u].push(e[C][c-u])}}return f},B=([e,t])=>`${e}_${t}`;return $}const he={},pe={xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24"},_e=s("path",{fill:"currentColor",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M6.906 4.537A.6.6 0 0 0 6 5.053v13.894a.6.6 0 0 0 .906.516l11.723-6.947a.6.6 0 0 0 0-1.032z"},null,-1),fe=[_e];function ve(d,p){return M(),R("svg",pe,fe)}const we=L(he,[["render",ve]]),ge={},me={xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24"},xe=s("path",{fill:"currentColor",d:"M8 19c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2s-2 .9-2 2v10c0 1.1.9 2 2 2m6-12v10c0 1.1.9 2 2 2s2-.9 2-2V7c0-1.1-.9-2-2-2s-2 .9-2 2"},null,-1),ye=[xe];function $e(d,p){return M(),R("svg",me,ye)}const Se=L(ge,[["render",$e]]),ke={},Ce={xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 48 48"},Me=s("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"4",d:"M31 36L19 24l12-12"},null,-1),Re=[Me];function Ie(d,p){return M(),R("svg",Ce,Re)}const De=L(ke,[["render",Ie]]),be={},ze={xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 48 48"},Te=s("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"4",d:"m19 12l12 12l-12 12"},null,-1),Be=[Te];function Le(d,p){return M(),R("svg",ze,Be)}const Ve=L(be,[["render",Le]]),Ee={},je={xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 256 256"},Oe=s("path",{fill:"currentColor",d:"m208.49 152.49l-72 72a12 12 0 0 1-17 0l-72-72a12 12 0 0 1 17-17L116 187V40a12 12 0 0 1 24 0v147l51.51-51.52a12 12 0 0 1 17 17Z"},null,-1),Ae=[Oe];function Ne(d,p){return M(),R("svg",je,Ae)}const Pe=L(Ee,[["render",Ne]]),Je={},qe={xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24"},Ge=s("g",{fill:"none"},[s("path",{d:"M24 0v24H0V0zM12.594 23.258l-.012.002l-.071.035l-.02.004l-.014-.004l-.071-.036q-.016-.004-.024.006l-.004.01l-.017.428l.005.02l.01.013l.104.074l.015.004l.012-.004l.104-.074l.012-.016l.004-.017l-.017-.427q-.004-.016-.016-.018m.264-.113l-.014.002l-.184.093l-.01.01l-.003.011l.018.43l.005.012l.008.008l.201.092q.019.005.029-.008l.004-.014l-.034-.614q-.005-.018-.02-.022m-.715.002a.02.02 0 0 0-.027.006l-.006.014l-.034.614q.001.018.017.024l.015-.002l.201-.093l.01-.008l.003-.011l.018-.43l-.003-.012l-.01-.01z"}),s("path",{fill:"currentColor",d:"M5.631 7.23a1.5 1.5 0 0 1 1.967-.446l.122.077l1.566 1.097a1.497 1.497 0 0 1 .5 2.048l-.078.118l-1.128 1.612a1.5 1.5 0 0 1-2.648-.373a7 7 0 0 0-.73.305a3.3 3.3 0 0 0-.553.332c.27.209.746.46 1.461.698c1.439.48 3.521.802 5.89.802s4.451-.322 5.89-.802c.716-.239 1.193-.49 1.462-.7l-.135-.095a4 4 0 0 0-.305-.178c-.686-.36-1.764-.702-3.157-.933a1.5 1.5 0 0 1 .49-2.96c1.57.26 2.992.674 4.066 1.24c.946.498 2.189 1.427 2.189 2.928c0 1.07-.652 1.852-1.279 2.346c-.643.507-1.481.898-2.383 1.198c-1.819.607-4.236.956-6.838.956s-5.02-.35-6.838-.956c-.902-.3-1.74-.691-2.383-1.198C2.152 13.852 1.5 13.07 1.5 12c0-.8.371-1.448.808-1.916c.43-.46.986-.82 1.567-1.107c.451-.223.96-.421 1.514-.595A1.5 1.5 0 0 1 5.63 7.23ZM12 3.5a1.5 1.5 0 0 1 1.493 1.356L13.5 5v7h-3V5A1.5 1.5 0 0 1 12 3.5M10.5 18v1a1.5 1.5 0 0 0 3 0v-1z"})],-1),He=[Ge];function Ze(d,p){return M(),R("svg",qe,He)}const Fe=L(Je,[["render",Ze]]),Ke={},Ue={xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 20 20"},We=s("g",{fill:"currentColor"},[s("path",{d:"M13.937 4.211a1 1 0 0 1-1.126 1.653A5 5 0 1 0 15 10a1 1 0 1 1 2 0a7 7 0 1 1-3.063-5.789"}),s("path",{d:"M13.539 12.506a1 1 0 1 1-1.078-1.685l3.482-2.227a1 1 0 0 1 1.077 1.685z"}),s("path",{d:"M18.903 12.41a1 1 0 0 1-1.826.815l-1.508-3.38a1 1 0 1 1 1.826-.815z"})],-1),Qe=[We];function Xe(d,p){return M(),R("svg",Ue,Qe)}const Ye=L(Ke,[["render",Xe]]),b=d=>(re("data-v-253f3683"),d=d(),ie(),d),et={class:"tetris-wrapper"},tt={class:"inner-wrapper"},st={class:"tetris-content"},nt={class:"info"},ot=b(()=>s("div",{class:"next"},"下一个",-1)),at={class:"next-box"},ct=b(()=>s("div",{class:"score_title"},"得分",-1)),lt={class:"score"},rt=b(()=>s("div",{class:"status_title"},"状态",-1)),it={class:"status"},ut=b(()=>s("span",{class:"label"},"开始",-1)),dt=b(()=>s("span",{class:"label"},"暂停",-1)),ht=b(()=>s("span",{class:"label"},"重玩",-1)),pt={key:0,class:"mask"},_t={class:"tetris-actions"},ft=b(()=>s("span",{class:"label"},"左移",-1)),vt=b(()=>s("span",{class:"label"},"右移",-1)),wt=b(()=>s("span",{class:"label"},"下移",-1)),gt=b(()=>s("span",{class:"label"},"旋转",-1)),v=18,mt=ae({__name:"index",setup(d){ue(I=>({"9dec1d7a":S.value}));const p=de(),T=[13,20],_=[5,2],S=se(()=>T[0]*v+24*2+"px"),m=G(),j=()=>{m.value.style.width=`${_[0]*v}px`,m.value.style.height=`${_[1]*v}px`},O=I=>{const l=document.createElement("div"),{type:P,shapData:V}=I,[w,J]=_,q=new Set,D=V.length,F=V[0].length;l.style.width=`${w*v}px`,l.style.height=`${J*v}px`,m.value.innerHTML=null;for(let g=0;g<D;g++)for(let k=0;k<F;k++)V[g][k]===1&&q.add(`${P==="O"?k+1:k}_${g}`);for(let g=0;g<J;g++)for(let k=0;k<w;k++){const z=document.createElement("div");z.style.width=z.style.height=`${v}px`,z.style.left=`${k*v}px`,z.style.top=`${g*v}px`,z.setAttribute("class",`rect rect-${q.has(`${k-1}_${g}`)?P:"bg"}`),l.appendChild(z)}m.value.appendChild(l)},x=G(),A=()=>{x.value.style.width=`${T[0]*v}px`,x.value.style.height=`${T[1]*v}px`},y=I=>{console.log("renderGame data: ",I);const l=document.createElement("div"),[P,V]=T;x.value.innerHTML=null,l.style.width=`${P*v}px`,l.style.height=`${V*v}px`,I.forEach(w=>{const[J,q]=w.vector,D=document.createElement("div");D.style.width=D.style.height=`${v}px`,D.style.left=`${J*v}px`,D.style.top=`${q*v}px`,D.setAttribute("class",`rect rect-${w.type}`),l.appendChild(D)}),x.value.appendChild(l)},h=G(-1),r=G(!1),H=se(()=>r.value?"暂停了":h.value<=1?"请开始游戏":h.value==2?"正在游戏中":h.value==3?"结束了":""),o=G(),Z=G(0),X=()=>{o.value=new p({screenSize:T,intervals:1e3}),console.log(o.value),o.value.update(()=>{y(o.value.map),O(o.value.nextShap),Z.value=o.value.score,h.value=o.value.status}),o.value&&document.addEventListener("keydown",I=>{const{keyCode:l}=I;l===37?o.value.action("left"):l===39?o.value.action("right"):l===38?o.value.action("change"):l===40&&o.value.action("lower")})},$=()=>{if(r.value)r.value=!1,o.value.play();else{if(o.value.ready(),r.value=!1,o.value.status!==1&&o.value.status!==2)return;o.value.play()}},K=()=>{o.value.status===2&&(o.value.pause(),r.value=!0)},Y=()=>{o.value.over(),h.value=o.value.status,r.value=!1,o.value.again()},U=()=>{o.value.action("left")},W=()=>{o.value.action("right")},Q=()=>{o.value.action("change")},N=()=>{o.value.action("lower")};return ce(()=>{j(),A(),X(),console.log("TJS.value: ",o.value)}),(I,l)=>(M(),R("div",et,[s("div",tt,[s("div",st,[s("div",{class:"tetris-container",ref_key:"tetrisContainerRef",ref:x},null,512),s("div",nt,[ot,s("div",at,[s("div",{class:"next-shape",ref_key:"nextShapeRef",ref:m},null,512)]),ct,s("div",lt,ee(Z.value),1),rt,s("div",it,ee(h.value),1),h.value<=1||r.value?(M(),R("div",{key:0,class:"action-item play",onClick:$},[E(we),ut])):(M(),R("div",{key:1,class:"action-item pause",onClick:K},[E(Se),dt])),s("div",{class:"action-item again",onClick:Y},[E(Ye),ht])]),h.value!==2||r.value?(M(),R("div",pt,ee(H.value),1)):le("",!0)]),s("div",_t,[s("div",{class:"left",onClick:U},[E(De),ft]),s("div",{class:"right",onClick:W},[E(Ve),vt]),s("div",{class:"down",onClick:N},[E(Pe),wt]),s("div",{class:"rotate",onClick:Q},[E(Fe),gt])])])]))}}),yt=L(mt,[["__scopeId","data-v-253f3683"]]);export{yt as default};
